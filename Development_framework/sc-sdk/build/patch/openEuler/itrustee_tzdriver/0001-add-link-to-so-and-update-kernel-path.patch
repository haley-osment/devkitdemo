diff --git a/CMakeLists.txt b/CMakeLists.txt
index 2b6abb7..2aa5c9d 100644
--- a/CMakeLists.txt
+++ b/CMakeLists.txt
@@ -24,11 +24,22 @@ endif()
 
 # you should config right path according to your run-time environment
 set(KPATH /usr/src/kernels)
-execute_process(COMMAND ls ${KPATH} OUTPUT_VARIABLE KDIR)
+execute_process(COMMAND rpm -qa|grep kernel-devel | head -n 1 | awk -F "kernel-devel-" '{print $$2}' OUTPUT_VARIABLE KDIR)
+
 # Remove the last char \n
 string(STRIP ${KDIR} KDIR)
 set(KERNEL_DIR ${KPATH}/${KDIR})
 
+# Add header file include directories
+include_directories(
+    ./
+    ./libboundscheck/include
+    ./auth
+    ./core
+    ./tlogger
+    ./kthread_affinity
+)
+
 # Set extra options
 set(CMAKE_EXTRA_FLAGS "-fstack-protector-strong -DCONFIG_TEELOG -DCONFIG_TZDRIVER_MODULE -DCONFIG_TEECD_AUTH -DCONFIG_PAGES_MEM=y -DCONFIG_CLOUDSERVER_TEECD_AUTH")
 set(CMAKE_EXTRA_FLAGS "${CMAKE_EXTRA_FLAGS} -DCONFIG_CPU_AFF_NR=0 -DCONFIG_BIG_SESSION=100 -DCONFIG_NOTIFY_PAGE_ORDER=4 -DCONFIG_512K_LOG_PAGES_MEM -DCONFIG_TEE_TRACE")
diff --git a/Makefile b/Makefile
index 8959347..e17e4bd 100644
--- a/Makefile
+++ b/Makefile
@@ -42,7 +42,8 @@ endif
 
 # you should config right path according to your run-time environment
 KPATH := /usr/src/kernels
-KDIR  := $(KPATH)/$(shell ls $(KPATH))
+KERNEL_VERSION := $(shell rpm -qa|grep kernel-devel | head -n 1 | awk -F "kernel-devel-" '{print $$2}')
+KDIR  := $(KPATH)/$(KERNEL_VERSION)
 
 EXTRA_CFLAGS += -isystem /usr/lib/gcc/aarch64-linux-gnu/10.3.1/include
 EXTRA_CFLAGS += -isystem /usr/lib/gcc/aarch64-openEuler-linux-gnu/12/include
